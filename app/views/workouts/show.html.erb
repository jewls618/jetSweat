<%= render 'layouts/header' %>

<% if current_user %>
  <div class="fav-form">
    <%= form_for [@workout, @favorite] do |f| %>
      <%= f.hidden_field :user_id %>
      <%= f.hidden_field :workout_id %>
      <%= f.submit "Add to Favorites", class: "fav-form" %>
   <% end %>
  </div>
<% end %>

<h1 id="workout-name"><%= @workout.name %></h1>

<% if current_user %>
  <% if current_user.admin? %>
    <button type="button"><%= link_to 'Edit Workout', edit_location_category_workout_path(@location.id, @category.id, @workout.id) %></button>
  <% end %>

  <% if current_user.admin? %>
    <button type="button"><%= link_to 'Delete Workout', location_category_workout_path(@location.id, @category.id, @workout.id), method: :delete %></button>
  <% end %>
<% end %>

  <h4>Address: <%= @workout.street%></h4>

<% if @yelp_data %>
  <ul>
    <% @yelp_data.businesses.each do |result| %>
      <li>Phone: <%= result.display_phone %></li>
      <li>Yelp Rating: <%= result.rating %></li>
      <li><%= link_to "Check out more on Yelp!", result.mobile_url, target: "blank", class: "yelp" %></li>
    <% end %>
  </ul>
<% end %>

<div id="map" style="width:100%;height:500px"></div>
<% binding.pry %>
<script>
  function myMap() {
    var mapCanvas = document.getElementById("map");
    var mapOptions = {
      center: new google.maps.LatLng(51.5, -0.2),
      zoom: 10
    }
    var map = new google.maps.Map(mapCanvas, mapOptions);
  }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB889X3aSeGkJCFzO3i6inz6SWOynZczDU&callback=myMap"></script>

<h3 class="comments">COMMENTS</h3>

<span><%= link_to 'Add New Comment', new_workout_comment_path(@workout.id), class: "comm" %></span><br />
<br />

<ul>
  <div class="comment">
    <% @comments.each do |c| %>
      <li class="body"><%= c.body %></li>
      <li class="reviewer">-<%= c.user.username %>
        <div class="options">
          <% if current_user %>
            <% if current_user.id == c.user_id %>
            <button type="button"><%= link_to 'Edit Comment', edit_workout_comment_path(@workout, c), class: "button", id: "edit-workout-review-button" %></button>
            <% end %>
            <% if current_user.id == c.user_id || current_user.admin? %>
              <button type="button"><%= link_to 'Delete Comment', workout_comment_path(@workout.id, c), method: :delete %></button>
            <% end %>
          <% end %>
        </div>
      </li>
    <% end %>
  </div>
</ul>
<br />

<span><%= link_to "Back to Results", location_category_workouts_path, class: "back" %></span>
